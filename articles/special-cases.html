<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Special Cases: Linear and Logistic Regression • kindling</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Playfair_Display-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Special Cases: Linear and Logistic Regression">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kindling</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/kindling.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/kindling.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/similar-packages.html">Similar packages and comparison</a></li>
    <li><a class="dropdown-item" href="../articles/tuning-capabilities.html">Tuning Capabilities</a></li>
    <li><a class="dropdown-item" href="../articles/special-cases.html">Linear and Logistic Regression (Special Cases)</a></li>
    <li><a class="dropdown-item" href="../articles/custom-act-fn.html">Custom Activation Function</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more">
<li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joshuamarie/kindling" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://joshuamarie.com"><span class="fa fa-blog"></span> Blog</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Special Cases: Linear and Logistic Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joshuamarie/kindling/blob/main/vignettes/special-cases.Rmd" class="external-link"><code>vignettes/special-cases.Rmd</code></a></small>
      <div class="d-none name"><code>special-cases.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="whats-so-special-about-kindling">What’s so special about {kindling}<a class="anchor" aria-label="anchor" href="#whats-so-special-about-kindling"></a>
</h2>
<p>This package is planned to make it compatible for any machine
learning task, even time series and image classification cam be
supported. Yes, you can do both linear regression and logistic
regression with extra steps: heavily customized optimizer and loss
functions. The <code><a href="../reference/gen-nn-train.html">train_nn()</a></code> function (available on
&gt;v0.3.x) supports this { <code>optimizer</code> <span class="math inline">\leftrightarrow</span> <code>optimizer_args</code> }
and { <code>loss</code> }. For both cases, the key is to remove all
hidden layers and rely entirely on the output layer and the appropriate
loss function to recover the classical model’s behavior.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>    <span class="va">kindling</span><span class="op">[</span><span class="va">train_nn</span>, <span class="va">act_funs</span>, <span class="va">args</span><span class="op">]</span>,</span>
<span>    <span class="va">recipes</span><span class="op">[</span></span>
<span>        <span class="va">recipe</span>, <span class="va">step_dummy</span>, <span class="va">step_normalize</span>,</span>
<span>        <span class="va">all_nominal_predictors</span>, <span class="va">all_numeric_predictors</span></span>
<span>    <span class="op">]</span>,</span>
<span>    <span class="va">rsample</span><span class="op">[</span><span class="va">initial_split</span>, <span class="va">training</span>, <span class="va">testing</span><span class="op">]</span>,</span>
<span>    <span class="va">yardstick</span><span class="op">[</span><span class="va">metric_set</span>, <span class="va">rmse</span>, <span class="va">rsq</span>, <span class="va">accuracy</span>, <span class="va">mn_log_loss</span><span class="op">]</span>,</span>
<span>    <span class="va">dplyr</span><span class="op">[</span><span class="va">mutate</span>, <span class="va">select</span><span class="op">]</span>,</span>
<span>    <span class="va">tibble</span><span class="op">[</span><span class="va">tibble</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-regression-as-a-special-case">Linear Regression as a Special Case<a class="anchor" aria-label="anchor" href="#linear-regression-as-a-special-case"></a>
</h2>
<p>A standard linear regression model predicts a continuous outcome as a
weighted sum of inputs — no nonlinearity, no hidden layers. A neural
network recovers this exactly when:</p>
<ul>
<li>There are <em>no hidden layers</em>
(<code>hidden_neurons = integer(0)</code> or simply omit it),</li>
<li>The <em>output activation is the identity</em> (i.e., no
activation), and</li>
<li>The common loss function is MSE, but we can choose different loss
function: (<code>loss = "mse"</code>).</li>
</ul>
<p>Under these conditions, gradient descent minimizes the same objective
as ordinary least squares, and the learned weights converge to the OLS
solution given sufficient epochs and a small learning rate.</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>We use <code>mtcars</code> to predict fuel efficiency
(<code>mpg</code>) from the other variables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">split</span> <span class="op">=</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">mtcars</span>, prop <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rec</span> <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">all_numeric_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h3>
<p>To create no hidden units, the <code>hidden_neuron</code> parameter
from <code><a href="../reference/gen-nn-train.html">train_nn()</a></code> considers the following to achieve:</p>
<ol style="list-style-type: decimal">
<li><code>NULL</code></li>
<li>Empty <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>
</li>
<li>No arguments at all</li>
</ol>
<p>In this example, the empty vector <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> is used and will
collapse the network to a single linear layer from inputs to output. The
<code>optimizer = "rmsprop"</code> with a small <code>learn_rate</code>
mirrors classical gradient descent for OLS.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_nn</span> <span class="op">=</span> <span class="fu"><a href="../reference/gen-nn-train.html">train_nn</a></span><span class="op">(</span></span>
<span>    <span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>    data <span class="op">=</span> <span class="va">train</span>,</span>
<span>    hidden_neurons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    loss <span class="op">=</span> <span class="fu">torch</span><span class="fu">::</span><span class="va"><a href="https://torch.mlverse.org/docs/reference/nnf_l1_loss.html" class="external-link">nnf_l1_loss</a></span>,</span>
<span>    optimizer <span class="op">=</span> <span class="st">"rmsprop"</span>, </span>
<span>    learn_rate <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_nn</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="font-weight: bold;">========================== Generalized Neural Network ==========================</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="font-style: italic;">-- Model Summary ---------------------------------------------------------------</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning in system("tput cols", intern = TRUE): running command 'tput cols' had</span></span>
<span><span class="co">## status 2</span></span></code></pre>
<pre><code><span><span class="co">## -------------------------------------------------------------------</span></span>
<span><span class="co">##   NN Model Type           :         FFNN    n_predictors :     10</span></span>
<span><span class="co">##   Number of Epochs        :          200    n_response   :      1</span></span>
<span><span class="co">##   Hidden Layer Units      :                 reg.         :   None</span></span>
<span><span class="co">##   Number of Hidden Layers :            0    Device       :    cpu</span></span>
<span><span class="co">##   Pred. Type              :   regression                 :       </span></span>
<span><span class="co">## -------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="font-style: italic;">-- Activation Functions --------------------------------------------------------</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning in system("tput cols", intern = TRUE): running command 'tput cols' had</span></span>
<span><span class="co">## status 2</span></span></code></pre>
<pre><code><span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">##    Layer {}         :   No act function applied</span></span>
<span><span class="co">##   Output Activation :   No act function applied</span></span>
<span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="font-style: italic;">-- Architecture Spec -----------------------------------------------------------</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning in system("tput cols", intern = TRUE): running command 'tput cols' had</span></span>
<span><span class="co">## status 2</span></span></code></pre>
<pre><code><span><span class="co">## --------------------------------------------------------------</span></span>
<span><span class="co">##   nn_layer        :   N/A    before_output_transform :   N/A</span></span>
<span><span class="co">##   out_nn_layer    :   N/A    after_output_transform  :   N/A</span></span>
<span><span class="co">##   nn_layer_args   :   N/A    last_layer_args         :   N/A</span></span>
<span><span class="co">##   layer_arg_fn    :   N/A    input_transform         :   N/A</span></span>
<span><span class="co">##   forward_extract :   N/A                            :      </span></span>
<span><span class="co">## --------------------------------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="evaluation">Evaluation<a class="anchor" aria-label="anchor" href="#evaluation"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_nn</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>    truth <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>    estimate <span class="op">=</span> <span class="va">preds</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">metric_set</span><span class="op">(</span><span class="va">rmse</span>, <span class="va">rsq</span><span class="op">)</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   .metric .estimator .estimate</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> rmse    standard       4.31 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> rsq     standard       0.948</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="comparison-with-lm">Comparison with <code>lm()</code><a class="anchor" aria-label="anchor" href="#comparison-with-lm"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>    truth <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">metric_set</span><span class="op">(</span><span class="va">rmse</span>, <span class="va">rsq</span><span class="op">)</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   .metric .estimator .estimate</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> rmse    standard       4.88 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> rsq     standard       0.493</span></span></code></pre>
<p>The two models should produce very similar RMSE and <span class="math inline">R^2</span> values. Any small gap reflects that
gradient descent is an iterative approximation, while <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
solves for the exact OLS coefficients directly. Increasing
<code>epochs</code> or switching to <code>optimizer = "lbfgs"</code> (if
supported) will close the gap further.</p>
</div>
</div>
<div class="section level2">
<h2 id="logistic-regression-as-a-special-case">Logistic Regression as a Special Case<a class="anchor" aria-label="anchor" href="#logistic-regression-as-a-special-case"></a>
</h2>
<p>Logistic regression models a binary or multiclass outcome by passing
a linear combination of inputs through a sigmoid or softmax activation.
A neural network with:</p>
<ul>
<li>
<strong>No hidden layers</strong>,</li>
<li>A <strong>sigmoid output</strong> for binary classification (or
softmax for multiclass), and</li>
<li>
<strong>Cross-entropy</strong> (<code>loss = "cross_entropy"</code>)
for the loss function</li>
</ul>
<p>is mathematically equivalent to logistic regression.</p>
<div class="section level3">
<h3 id="binary-logistic-regression">Binary Logistic Regression<a class="anchor" aria-label="anchor" href="#binary-logistic-regression"></a>
</h3>
<p>We use the <code>Sonar</code> dataset from <code>{mlbench}</code> to
distinguish rocks from mines (binary outcome).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Sonar"</span>, package <span class="op">=</span> <span class="st">"mlbench"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sonar</span> <span class="op">=</span> <span class="va">Sonar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">split_s</span> <span class="op">=</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">sonar</span>, prop <span class="op">=</span> <span class="fl">0.8</span>, strata <span class="op">=</span> <span class="va">Class</span><span class="op">)</span></span>
<span><span class="va">train_s</span> <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">split_s</span><span class="op">)</span></span>
<span><span class="va">test_s</span> <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split_s</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rec_s</span> <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_s</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">all_numeric_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logit_nn</span> <span class="op">=</span> <span class="fu"><a href="../reference/gen-nn-train.html">train_nn</a></span><span class="op">(</span></span>
<span>    <span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>    data <span class="op">=</span> <span class="va">train_s</span>,</span>
<span>    hidden_neurons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    loss <span class="op">=</span> <span class="st">"cross_entropy"</span>,</span>
<span>    optimizer <span class="op">=</span> <span class="st">"adam"</span>,</span>
<span>    learn_rate <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">logit_nn</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="font-weight: bold;">========================== Generalized Neural Network ==========================</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="font-style: italic;">-- Model Summary ---------------------------------------------------------------</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning in system("tput cols", intern = TRUE): running command 'tput cols' had</span></span>
<span><span class="co">## status 2</span></span></code></pre>
<pre><code><span><span class="co">## -----------------------------------------------------------------------</span></span>
<span><span class="co">##   NN Model Type           :             FFNN    n_predictors :     60</span></span>
<span><span class="co">##   Number of Epochs        :              200    n_response   :      2</span></span>
<span><span class="co">##   Hidden Layer Units      :                     reg.         :   None</span></span>
<span><span class="co">##   Number of Hidden Layers :                0    Device       :    cpu</span></span>
<span><span class="co">##   Pred. Type              :   classification                 :       </span></span>
<span><span class="co">## -----------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="font-style: italic;">-- Activation Functions --------------------------------------------------------</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning in system("tput cols", intern = TRUE): running command 'tput cols' had</span></span>
<span><span class="co">## status 2</span></span></code></pre>
<pre><code><span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">##    Layer {}         :   No act function applied</span></span>
<span><span class="co">##   Output Activation :   No act function applied</span></span>
<span><span class="co">## -------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="font-style: italic;">-- Architecture Spec -----------------------------------------------------------</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning in system("tput cols", intern = TRUE): running command 'tput cols' had</span></span>
<span><span class="co">## status 2</span></span></code></pre>
<pre><code><span><span class="co">## --------------------------------------------------------------</span></span>
<span><span class="co">##   nn_layer        :   N/A    before_output_transform :   N/A</span></span>
<span><span class="co">##   out_nn_layer    :   N/A    after_output_transform  :   N/A</span></span>
<span><span class="co">##   nn_layer_args   :   N/A    last_layer_args         :   N/A</span></span>
<span><span class="co">##   layer_arg_fn    :   N/A    input_transform         :   N/A</span></span>
<span><span class="co">##   forward_extract :   N/A                            :      </span></span>
<span><span class="co">## --------------------------------------------------------------</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logit_nn</span>, newdata <span class="op">=</span> <span class="va">test_s</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>    truth <span class="op">=</span> <span class="va">test_s</span><span class="op">$</span><span class="va">Class</span>,</span>
<span>    estimate <span class="op">=</span> <span class="va">preds_s</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">accuracy</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   .metric  .estimator .estimate</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> accuracy binary         0.744</span></span></code></pre>
<!-- ### Multiclass Logistic Regression -->
<!-- For more than two classes, cross-entropy loss with a softmax output generalizes logistic regression. We demonstrate on `iris` with three species. -->
<!-- ```{r multiclass-data} -->
<!-- set.seed(42) -->
<!-- split_i = initial_split(iris, prop = 0.8, strata = Species) -->
<!-- train_i = training(split_i) -->
<!-- test_i = testing(split_i) -->
<!-- rec_i = recipe(Species ~ ., data = train_i) |> -->
<!--     step_normalize(all_numeric_predictors()) -->
<!-- ``` -->
<!-- ```{r multiclass-fit} -->
<!-- softmax_nn = train_nn( -->
<!--     Species ~ ., -->
<!--     data = train_i, -->
<!--     hidden_neurons = integer(0), -->
<!--     loss = "cross_entropy", -->
<!--     optimizer = "adam", -->
<!--     learn_rate = 0.01, -->
<!--     epochs = 300, -->
<!--     verbose = FALSE -->
<!-- ) -->
<!-- softmax_nn -->
<!-- ``` -->
<!-- ```{r multiclass-eval} -->
<!-- preds_i = predict(softmax_nn, newdata = test_i, type = "class") -->
<!-- tibble( -->
<!--     truth = test_i$Species, -->
<!--     estimate = preds_i -->
<!-- ) |> -->
<!--     accuracy(truth = truth, estimate = estimate) -->
<!-- ``` -->
</div>
<div class="section level3">
<h3 id="comparison-with-glm-nnetmultinom">Comparison with <code>glm()</code> /
<code>nnet::multinom()</code><a class="anchor" aria-label="anchor" href="#comparison-with-glm-nnetmultinom"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">nnet</span><span class="op">[</span><span class="va">multinom</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glm_fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_s</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: glm.fit: algorithm did not converge</span></span></code></pre>
<pre><code><span><span class="co">## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span></span>
<span>    truth <span class="op">=</span> <span class="va">test_s</span><span class="op">$</span><span class="va">Class</span>,</span>
<span>    estimate <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="va">preds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">glm_fit</span>, newdata <span class="op">=</span> <span class="va">test_s</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">preds</span> <span class="op">&lt;</span> <span class="fl">0.5</span>, <span class="st">"M"</span>, <span class="st">"R"</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">accuracy</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   .metric  .estimator .estimate</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> accuracy binary         0.698</span></span></code></pre>
<!-- > To learn more about `=>`, it is a pipe-bind operator by running this on your R console: `Sys.setenv("_R_USE_PIPEBIND_" = TRUE)` -->
<p>Again, accuracy should be comparable between the two approaches. The
neural network version converges iteratively, so the match is not
guaranteed to be exact, but both are optimizing the same cross-entropy
objective over a linear model.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua Marie, Antoine Soetewey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>. Visit my <a href="https://joshuamarie.com" class="external-link">blog</a> for more content.</p>
</div>

    </footer>
</div>





  </body>
</html>
